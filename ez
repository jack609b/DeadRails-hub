if not (game.Players.LocalPlayer.Name == "phevatvaiz" or game.Players.LocalPlayer:IsFriendsWith(628824142)) then
    game.Players.LocalPlayer:Kick("Script này chỉ dành cho phevatvaiz hoặc bạn bè.")
    return
end

local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()
local Window = OrionLib:MakeWindow({Name = "Dead Rails-hub | By: Minh", HidePremium = false, SaveConfig = true, ConfigFolder = "DeadRailsHub"})

local MainTab = Window:MakeTab({Name = "Chính", Icon = "rbxassetid://4483345998", PremiumOnly = false})
local MovementTab = Window:MakeTab({Name = "Di chuyển", Icon = "rbxassetid://4483345998", PremiumOnly = false})
local VisualTab = Window:MakeTab({Name = "Hình ảnh", Icon = "rbxassetid://4483345998", PremiumOnly = false})
local ProtectionTab = Window:MakeTab({Name = "Bảo vệ", Icon = "rbxassetid://4483345998", PremiumOnly = false})

-- Gun Aura
local gunAura = false
MainTab:AddToggle({
    Name = "Gun Aura (Tự bắn gần)",
    Default = false,
    Callback = function(val)
        gunAura = val
        task.spawn(function()
            while gunAura do
                local tool = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChildOfClass("Tool")
                if tool and tool:FindFirstChild("Handle") then
                    for _, player in ipairs(game.Players:GetPlayers()) do
                        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                            local dist = (player.Character.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                            if dist < 20 then
                                tool:Activate()
                                tool.Handle.CFrame = player.Character.HumanoidRootPart.CFrame
                            end
                        end
                    end
                end
                task.wait(0.3)
            end
        end)
    end
})

-- Auto Collect Bond & Ammo
MainTab:AddButton({
    Name = "Thu thập Bond & Ammo",
    Callback = function()
        for _, obj in ipairs(workspace:GetDescendants()) do
            if obj:IsA("Tool") and obj:FindFirstChild("Handle") and (obj.Name:lower():find("bond") or obj.Name:lower():find("ammo")) then
                firetouchinterest(game.Players.LocalPlayer.Character.HumanoidRootPart, obj.Handle, 0)
                firetouchinterest(game.Players.LocalPlayer.Character.HumanoidRootPart, obj.Handle, 1)
            end
        end
    end
})

-- ESP cập nhật liên tục
local function addESP(player)
    if player ~= game.Players.LocalPlayer then
        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart", 5)
        if hrp then
            local box = Instance.new("BoxHandleAdornment")
            box.Adornee = hrp
            box.Size = Vector3.new(4, 6, 4)
            box.AlwaysOnTop = true
            box.ZIndex = 10
            box.Color3 = Color3.fromRGB(255, 0, 0)
            box.Transparency = 0.5
            box.Name = "ESPBox"
            box.Parent = hrp
        end
    end
end

MainTab:AddButton({
    Name = "Bật ESP",
    Callback = function()
        for _, p in ipairs(game.Players:GetPlayers()) do addESP(p) end
        game.Players.PlayerAdded:Connect(addESP)
    end
})

-- Bypass to End
MainTab:AddButton({
    Name = "Dịch chuyển đến cuối màn",
    Callback = function()
        local endPart
        for _, obj in ipairs(workspace:GetDescendants()) do
            if obj:IsA("BasePart") and obj.Name:lower():find("end") and obj.Position.Y < 500 then
                endPart = obj
                break
            end
        end
        if endPart then
            game.Players.LocalPlayer.Character:MoveTo(endPart.Position + Vector3.new(0, 5, 0))
        else
            warn("Không tìm thấy điểm cuối.")
        end
    end
})

-- Unlock camera zoom
MainTab:AddButton({
    Name = "Mở Zoom Tối Đa",
    Callback = function()
        game.Players.LocalPlayer.CameraMaxZoomDistance = 999
        game.Players.LocalPlayer.CameraMinZoomDistance = 0.5
    end
})

-- Full Bright
VisualTab:AddButton({
    Name = "Full sáng",
    Callback = function()
        local l = game:GetService("Lighting")
        l.Brightness = 2
        l.ClockTime = 14
        l.FogEnd = 100000
        l.GlobalShadows = false
    end
})

-- Infinite Jump
local infiniteJump = false
MovementTab:AddToggle({
    Name = "Nhảy vô hạn",
    Default = false,
    Callback = function(v) infiniteJump = v end
})

game:GetService("UserInputService").JumpRequest:Connect(function()
    if infiniteJump then
        local h = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if h then h:ChangeState(Enum.HumanoidStateType.Jumping) end
    end
end)

-- WalkSpeed
MovementTab:AddSlider({
    Name = "Tốc độ",
    Min = 16,
    Max = 100,
    Default = 16,
    Increment = 1,
    Callback = function(v)
        game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid").WalkSpeed = v
    end
})

-- NoClip
local noclip = false
MovementTab:AddToggle({
    Name = "Xuyên tường (NoClip)",
    Default = false,
    Callback = function(v) noclip = v end
})

game:GetService("RunService").Stepped:Connect(function()
    if noclip then
        for _, part in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- Anti Kick
ProtectionTab:AddButton({
    Name = "Bật chống kick",
    Callback = function()
        local mt = getrawmetatable(game)
        setreadonly(mt, false)
        local old = mt.__namecall
        mt.__namecall = newcclosure(function(self, ...)
            if getnamecallmethod() == "Kick" then return end
            return old(self, ...)
        end)
        setreadonly(mt, true)
    end
})

-- Vô hạn tiền (Client-side fake)
MainTab:AddButton({
    Name = "Vô hạn $ (Hiển thị)",
    Callback = function()
        local gui = game.Players.LocalPlayer:FindFirstChild("PlayerGui")
        if gui then
            for _, v in pairs(gui:GetDescendants()) do
                if v:IsA("TextLabel") and v.Text:find("Money") then
                    v.Text = "Money: 999999"
                end
            end
        end
    end
})
