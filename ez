-- [üåü Script Dead Rails All-In-One vFinal - By You]
-- ‚úÖ OrionLib GUI + Full t√≠nh nƒÉng + Ch·ªâ b·∫°n b√® 4 ID ƒë∆∞·ª£c d√πng

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local FriendsAllowed = {
    [5231420503] = true,
    [8348136049] = true,
    [3019899298] = true,
    [1845194807] = true,
}

-- Ki·ªÉm tra b·∫°n b√®
local function IsFriend()
    local success, result = pcall(function()
        return HttpService:JSONDecode(game:HttpGet("https://friends.roblox.com/v1/users/" .. LocalPlayer.UserId .. "/friends"))
    end)
    if success then
        for _, friend in ipairs(result.data) do
            if FriendsAllowed[friend.id] then
                return true
            end
        end
    end
    return false
end

if not IsFriend() then
    LocalPlayer:Kick("B·∫°n kh√¥ng c√≥ quy·ªÅn s·ª≠ d·ª•ng script n√†y!")
    return
end

-- [üß† Anti Kick Nh·∫π]
local mt = getrawmetatable(game)
setreadonly(mt, false)
local oldNamecall = mt.__namecall
mt.__namecall = newcclosure(function(self, ...)
    local args = {...}
    if getnamecallmethod() == "Kick" and self == LocalPlayer then
        return
    end
    return oldNamecall(self, unpack(args))
end)

-- [üß∞ T·∫£i OrionLib GUI]
local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()
local Window = OrionLib:MakeWindow({Name = "Dead Rails Hub", HidePremium = false, SaveConfig = true, ConfigFolder = "DeadRailsState"})

-- [üåü Tabs]
local MainTab = Window:MakeTab({Name = "Main", Icon = "rbxassetid://4483345998", PremiumOnly = false})
local MiscTab = Window:MakeTab({Name = "Misc", Icon = "rbxassetid://4483345998", PremiumOnly = false})

-- [‚ö° Gun Aura]
local auraActive = false
MainTab:AddToggle({
    Name = "Gun Aura",
    Default = false,
    Save = true,
    Callback = function(v)
        auraActive = v
        while auraActive and task.wait(0.1) do
            for _, plr in pairs(Players:GetPlayers()) do
                if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and (plr.Team ~= LocalPlayer.Team) then
                    local tool = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Tool")
                    if tool and tool:FindFirstChild("Shoot") then
                        tool.Shoot:FireServer(plr.Character.HumanoidRootPart.Position)
                    end
                end
            end
        end
    end
})

-- [üí∞ Auto Farm Bond]
local autoFarm = false
MainTab:AddToggle({
    Name = "Auto Collect Bond",
    Default = false,
    Save = true,
    Callback = function(v)
        autoFarm = v
        while autoFarm and task.wait(1) do
            for _, v in pairs(workspace:GetDescendants()) do
                if v:IsA("TouchTransmitter") and v.Parent and v.Parent:FindFirstChild("TouchInterest") then
                    firetouchinterest(LocalPlayer.Character.HumanoidRootPart, v.Parent, 0)
                    firetouchinterest(LocalPlayer.Character.HumanoidRootPart, v.Parent, 1)
                end
            end
        end
    end
})

-- [üëÅ ESP]
local espEnabled = false
function EnableESP()
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and not player.Character:FindFirstChild("NameESP") then
            local bill = Instance.new("BillboardGui", player.Character)
            bill.Name = "NameESP"
            bill.Size = UDim2.new(0, 100, 0, 20)
            bill.Adornee = player.Character:FindFirstChild("Head")
            bill.AlwaysOnTop = true

            local name = Instance.new("TextLabel", bill)
            name.Size = UDim2.new(1, 0, 1, 0)
            name.BackgroundTransparency = 1
            name.TextColor3 = Color3.fromRGB(255, 0, 0)
            name.TextStrokeTransparency = 0
            name.Text = player.Name
        end
    end
end

Players.PlayerAdded:Connect(function(player)
    if espEnabled then
        player.CharacterAdded:Connect(function()
            task.wait(1)
            EnableESP()
        end)
    end
end)

MainTab:AddToggle({
    Name = "ESP",
    Default = false,
    Save = true,
    Callback = function(v)
        espEnabled = v
        if espEnabled then
            EnableESP()
        else
            for _, plr in ipairs(Players:GetPlayers()) do
                if plr.Character and plr.Character:FindFirstChild("NameESP") then
                    plr.Character.NameESP:Destroy()
                end
            end
        end
    end
})

-- [üé• Unlock Camera]
MainTab:AddButton({
    Name = "Unlock Camera",
    Callback = function()
        LocalPlayer.CameraMaxZoomDistance = 999
        LocalPlayer.CameraMinZoomDistance = 0
    end
})

-- [üåû Full Bright]
MainTab:AddButton({
    Name = "Full Bright",
    Callback = function()
        game.Lighting.Brightness = 2
        game.Lighting.ClockTime = 12
        game.Lighting.FogEnd = 100000
    end
})

-- [ü™Ç Infinite Jump]
local infJump = false
MainTab:AddToggle({
    Name = "Infinite Jump",
    Default = false,
    Save = true,
    Callback = function(v)
        infJump = v
    end
})

game:GetService("UserInputService").JumpRequest:Connect(function()
    if infJump then
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
    end
end)

-- [üèÉ WalkSpeed]
MainTab:AddSlider({
    Name = "WalkSpeed",
    Min = 16,
    Max = 100,
    Default = 16,
    Save = true,
    Callback = function(v)
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid").WalkSpeed = v
    end
})

-- [üëª NoClip]
local noclip = false
MainTab:AddToggle({
    Name = "NoClip",
    Default = false,
    Save = true,
    Callback = function(v)
        noclip = v
    end
})

game:GetService("RunService").Stepped:Connect(function()
    if noclip and LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") and part.CanCollide then
                part.CanCollide = false
            end
        end
    end
end)

-- [üöÄ Auto Win / Bypass to End]
MainTab:AddButton({
    Name = "Auto Win",
    Callback = function()
        local c = LocalPlayer.Character
        if c then
            c:MoveTo(Vector3.new(9999, 100, 0)) -- ‚ö†Ô∏è T√πy map ch·ªânh t·ªça ƒë·ªô win
        end
    end
})

-- [üß¨ Clone T·ª± T·∫•n C√¥ng NPC ƒë√°nh m√¨nh]
MiscTab:AddButton({
    Name = "Clone Auto Attack NPC",
    Callback = function()
        local clone = LocalPlayer.Character:Clone()
        clone.Parent = workspace
        clone.Name = "AttackClone"
        clone.HumanoidRootPart.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame
        clone.Humanoid.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.None

        -- C·∫ßm tool c·ªßa m√¨nh
        local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
        if tool then
            local cloneTool = tool:Clone()
            cloneTool.Parent = clone
            cloneTool:Activate()
        end

        local attackedNPCs = {}

        -- Ghi nh·ªõ NPC t·ª´ng ƒë√°nh
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid").HealthChanged:Connect(function(hp)
            if hp < LocalPlayer.Character.Humanoid.MaxHealth then
                for _, npc in pairs(workspace:GetDescendants()) do
                    if npc:IsA("Model") and npc:FindFirstChild("Humanoid") and npc:FindFirstChild("HumanoidRootPart") then
                        if (npc.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude < 30 then
                            attackedNPCs[npc] = true
                        end
                    end
                end
            end
        end)

        -- Di chuy·ªÉn clone t·∫•n c√¥ng c√°c NPC ƒë√£ ƒë√°nh m√¨nh
        task.spawn(function()
            while task.wait(1) do
                for npc, _ in pairs(attackedNPCs) do
                    if npc:FindFirstChild("HumanoidRootPart") and clone and clone:FindFirstChild("HumanoidRootPart") then
                        clone:MoveTo(npc.HumanoidRootPart.Position)
                    end
                end
            end
        end)
    end
})

OrionLib:Init()
